# Семантика языка


## Общая структура программы

Программа состоит из глобальных объявлений переменных и определений функций.  
Перед началом выполнения инициализируются глобальные переменные (в порядке их объявления), после чего вызывается функция `main`.  
Внутри функций и блоков инструкции выполняются сверху вниз. Каждая инструкция обязательно должна заканчиваться точкой с запятой `;`

## Типы данных

В языке поддерживаются два встроенных типа данных: 

| Тип      | Описание                           | Пример литерала | Соответсвующий тип в C# | Особенности                        |
| -------- | ---------------------------------- | --------------- | ----------------------- | ---------------------------------- |
| `int`    | Целое число (знаковое, 32 бита)    | `123`, `0`      | 32-битный `int`         | от -2 147 483 648 до 2 147 483 647 |
| `float`  | Число с плавающей точкой (64 бита) | `3.14`, `0.5`   | 64-битный `double`      | от 5,0 * 10^-324 до 1,7 * 10^308   |
| `string` | Строка произвольной длины          | `"hello"`       | UTF-16 `string`         | Неизменяемая (как в C#)            |
| `bool`   | Логическое значение                | `true`, `false` | `bool`                  |                -                   |
| `void`   | Отсутствие значения                | –               | `void`                   | Используется только для функций    |

Над числовыми типами можно проводить операции:
- арифметические: `+`, `-`, `*`, `/`, `**`, унарный `-`
- присваивания: `=`

Но при этом оба операнда арифметической операции должны быть одного типа. Операции между `float` и `int` запрещены. Однако унарный минус применим к любому числовому типу 

Для строковых типов поддерживается конкатенация с помощью `+`, при этом оба операнда должны быть типа `string`. Результатом такой операции является новая строка, полученная путем слияния левой и правой строки

Также не поддерживаются ни явные, ни неявные преобразования типов.

## Переменные и область видимости

### Объявление переменных
Переменные объявляются с помощью ключевых слов `let` (изменяемая) или `const` (константа):
- При объявлении обязательно должны быть указаны тип и инициализатор, при этом тип инициализированного значения должен совпадать с указанным типом переменной
- Идентификатор  переменной должен быть уникальным в пределах глобальной области видимости, повторное объявление с тем же именем запрещено
- Вычисленное выражение инициализатора справа присваивается новой переменной

Нельзя использовать идентифакатор до его объявления

## Область видимости

Переменные могут быть объявлены в глобальной области (вне блоков до ` main`) или внутри блоков `{ }`

- Блок создаёт новую вложенную область видимости
- Переменная, объявленная внутри блока, видна только в этом блоке (и во вложенных блоках)
- Внутри блока можно объявить переменную с тем же именем, что и во внешней области. Внутри блока будет видна новая переменная, внешняя становится недоступной до выхода из блока
- Время жизни локальной переменной – от точки объявления до конца блока
- Использование переменной до её объявления в текущей области запрещено
- После выхода из блока все его локальные переменные уничтожаются, и внешняя область восстанавливается

Глобальные переменные видны во всей программе после точки их объявления.

### Присваивание
Присваивание значения уже объявленной переменной выполняется с помощью оператора `=`, при этом:

- Переменная должна быть объявлена ранее
- Тип выражения должен совпадать с типом переменной
- Константе (`const`) нельзя присваивать новое значение

## Выражения

### Порядок вычисления
Выражения вычисляются в соответствии с приоритетом и ассоциативностью операций. Операнды бинарных операций вычисляются слева направо.

| Уровень | Операции                          | Ассоциативность |
|---------|-----------------------------------|-----------------|
| 1       | `( )`                             | –               |
| 2       | унарные: `-`, `!`                 | справа          |
| 3       | `**`                              | справа          |
| 4       | `*`, `/`                          | слева           |
| 5       | `+`, `-`                          | слева           |
| 6       | `<`, `>`, `<=`, `>=`, `==`, `!=`  | слева           |
| 7       | `&&`                              | слева           |
| 8       | `||`                              | слева           |


Оператор `=` используется только в инструкциях присваивания и не может входить в состав выражений (например, `a = b = c` недопустимо)

### Семантика операций
- Унарный минус `-x`: возвращает значение `x` с противоположным знаком
- Возведение в степень `x ** y`: возвращает результат возведения `x` в степень `y`
- Умножение `*`, деление `/`, сложение `+`, вычитание `-`: выполняют соответствующие арифметические действия с учётом правил типов
- Скобки `( )`: изменяют порядок вычисления, выражение в скобках вычисляется первым
- Унарный оператор `!`:  операнд должен быть типа `bool`, отрицает значение, т.е. результат `true`, если операнд `false`, и `false`, если операнд `true`
- Бинарный оператор `&&`: оба операнда должны быть `bool`, вычисляется по short‑circuit:
    - Сначала вычисляется левый операнд
    - Если он равен `false`, результат всего выражения `false`, правый операнд не вычисляется
    - Если левый равен `true`, вычисляется правый операнд и возвращается его значение
- Бинарный оператор `||`: оба операнда должны быть `bool`, вычисляется по short‑circuit:
    - Вычисляется левый операнд
    - Если он равен `true`, результат `true`, правый операнд не вычисляется
    - Если левый равен `false`, вычисляется правый операнд и возвращается его значение
- Бинарные операторы `<`, `>`, `<=`, `>=`, `==`, `!=`: оба операнда должны иметь одинаковый тип (`int`, `float`, `bool`, для строковых типов `string`  не поддерживается). Результат операции имеет тип `bool`. Значение результата:
  - `x < y`  – истина, если x меньше y.
  - `x > y`  – истина, если x больше y.
  - `x <= y` – истина, если x меньше или равно y.
  - `x >= y` – истина, если x больше или равно y.
  - `x == y` – истина, если x равно y.
  - `x != y` – истина, если x не равно y.


### Литералы
- Целые литералы (`123`) имеют тип `int`
- Вещественные литералы (`3.14`) имеют тип `float`
- Строковые литералы (`"hello"`) имеют тип `string`, может быть пустой
- Литералы `true` и `false` имеют тип bool
- Отрицательные числа записываются с помощью унарного минуса перед литералом

## Ввод

`input(идентифакатор)`:
- Ожидает ввод строки с клавиатуры (до перевода строки)
- Ведущие и завершающие пробелы во введённой строке игнорируются
- Строка преобразуется в тип переменной:
  - Для `int`: ожидается целое число (возможно со знаком). Если строка не является корректным целым, возникает ошибка выполнения
  - Для `float`: ожидается число в формате с плавающей точкой (например, `3.14` или `-0.5`). Если преобразование невозможно – ошибка
  -  Для `string`: значение присваивается как есть (без преобразования)
- Полученное значение сохраняется в переменную
- Несколько инструкций `input` выполняются последовательно, каждая ожидает свой ввод

## Вывод

`print(выражение1, выражение2, ...)`:

- Вычисляются все переданные выражения в порядке слева направо
- Поддерживаются типы `int`, `float`, `string`
- Вывод значений производится в стандартный поток вывода:
  - `int` – десятичное представление без лишних нулей
  - `float` – представление с плавающей точкой (например, `3.14`), не менее одного знака после запятой
  - `string` – содержимое строки без кавычек
- Значения разделяются одним пробелом
- После вывода всех значений добавляется перевод строки
- Если список выражений пуст (т.е. `print();`), выводится только пустая строка (перевод строки)
 Несколько инструкций `print` выполняются последовательно

## Условная инструкция if

- Условие – выражение типа bool
- Сначала вычисляется условие
- Если оно истинно (`true`), выполняется блок инструкций после `if`
- Иначе, если присутствует ветка `else`, выполняется блок после `else`
- Если `else` отсутствует и условие ложно, ничего не выполняется
- Блоки могут содержать любые инструкции, включая другие `if` 
- Фигурные скобки обязательны, даже если в блоке одна инструкция

## Функции

Функции определяются с помощью ключевого слова `func`:
- Тип возврата может быть `int`, `float`, `string`, `bool` или `void`. Для `void`-функций инструкция `return` может отсутствовать или использоваться без выражения
- `параметры` – список вида `имя: тип`, разделённый запятыми. Параметры являются неизменяемыми переменными (константами) внутри тела функции – присваивание им запрещено
- Тело функции – блок инструкций `{ ... }`
- Функция должна содержать инструкцию `return` с выражением, если тип возврата не `void`. Все пути выполнения должны заканчиваться `return` (проверка семантики)
- Функции могут вызывать другие функции, но рекурсивные вызовы не поддерживаются
- Функции имеют глобальную область видимости: они доступны из любого места программы после точки объявления
- Внутри функции создаётся новая локальная область видимости, в которую входят параметры и локальные переменные, объявленные внутри функции. Локальные переменные скрывают глобальные с теми же именами
- Вызов функции осуществляется по имени со списком аргументов в скобках
- Количество и типы аргументов должны соответствовать параметрам функции. Несоответствие вызывает ошибку семантики
- Результат вызова должен иметь тип, объявленный в функции

## Главная функция main

Программа обязана содержать функцию с именем `main`, типом возврата `void` и без параметров. Она является точкой входа:
- Если функция `main` отсутствует, имеет другой тип возврата или параметры, программа считается некорректной
- После инициализации глобальных переменных выполняется вызов `main()`. Завершение `main` означает завершение программы

## Цикл while
- `условие` – выражение типа `bool`. Вычисляется перед каждой итерацией
- Тело цикла выполняется, пока условие истинно
- В теле цикла могут использоваться инструкции `break` и `continue`

## Инструкции break и continue
- `break;` – немедленно завершает выполнение самого внутреннего цикла `while`, в котором находится. Управление передаётся на инструкцию, следующую за этим циклом
- `continue;` – немедленно переходит к следующей итерации самого внутреннего цикла
- Использование `break` или `continue` вне какого-либо цикла является семантической ошибкой

## Инструкция return
- Может использоваться только внутри тела функции
- Если функция объявлена с типом возврата, отличным от `void`, инструкция `return` должна содержать выражение, тип которого точно совпадает с объявленным типом
- В `void`-функции `return` может быть без выражения или отсутствовать; допускается несколько `return` в разных ветках
- При выполнении `return` выражение (если есть) вычисляется, затем управление возвращается в точку вызова, и значение становится результатом вызова

## Ошибки которые могут возникнуть во время выполнения
При выполнении программой следующих случаев могут возникать ошибки:
- Деление на ноль в операциях `/`
- Переполнение при арифметических операциях
- Если введённая строка не может быть преобразован в ожмадаемый тип
- Возведение в степень с некорректными аргументами(ноль в отрицательну степень, отрицательное основание в дробну степень)
